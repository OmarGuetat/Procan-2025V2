<div class="container-fluid mt-3">
  <div class="row g-3 mb-4">
    <!-- Year Filter -->
    <div class="col-xl-3">
      <h5 class="fw-bold"><i class="bi bi-filter"></i> Filter by Year</h5>
      <select id="yearFilter" class="form-control" [(ngModel)]="selectedYear" (change)="onYearChange()">
        <option [ngValue]="null">All</option>
        <option *ngFor="let year of availableYears" [value]="year">{{ year }}</option>
      </select>
    </div>

    <!-- Leave Type Filter -->
    <div class="col-xl-3">
      <h5 class="fw-bold"><i class="bi bi-filter"></i> Filter by Leave Type</h5>
      <select id="leaveTypeFilter" class="form-control" [(ngModel)]="selectedType" (change)="onLeaveTypeChange()">
        <option [ngValue]="null">All</option>
        <option *ngFor="let type of leaveTypes" [value]="type">{{ formatLeaveType(type) }}</option>
      </select>
    </div>

    <!-- Status Filter -->
    <div class="col-xl-3">
      <h5 class="fw-bold"><i class="bi bi-filter"></i> Filter by Status</h5>
      <select class="form-control" [(ngModel)]="selectedStatus" (change)="onStatusChange()">
        <option [ngValue]="null">All</option>
        <option value="approved">Approved</option>
        <option value="rejected">Rejected</option>
        <option value="on_hold">On Hold</option>
      </select>
    </div>
  </div>
<!-- Totals Information: Show only when a year is selected -->
<div *ngIf="selectedYear" class="row g-4 align-items-center mb-3">
  <div class="col-auto">
    <p class="mb-0">
      <i class="bi bi-calendar3 me-1"></i> 
      <strong>Total Leave Days:</strong> {{ totalLeaveDays }}
    </p>
  </div>
  <div class="col-auto">
    <p class="mb-0">
      <i class="bi bi-check-circle-fill text-success me-1"></i>
      <strong>Approved:</strong> {{ totalApprovedTimes }}
    </p>
  </div>
  <div class="col-auto">
    <p class="mb-0">
      <i class="bi bi-x-circle-fill text-danger me-1"></i> 
      <strong>Rejected:</strong> {{ totalRejectedTimes }}
    </p>
  </div>
  <div class="col-auto">
    <p class="mb-0">
      <i class="bi bi-hourglass-split text-warning me-1"></i> 
      <strong>On Hold:</strong> {{ totalOnHoldTimes }}
    </p>
  </div>
</div>

  <div *ngIf="leaveRequests.length > 0; else noRequests">
    <div class="row row-cols-1 row-cols-xxl-3 row-cols-xl-2 g-4">
      <div class="col" *ngFor="let request of leaveRequests">
        <app-request-card [request]="request" [showMenu]="true"></app-request-card>
      </div>
    </div>
  </div>

  <ng-template #noRequests>
    <div class="text-center mt-4">
      <h5 style="color: black;">No leave requests found.</h5>
    </div>
  </ng-template>

  <!-- Pagination Controls -->
  <div class="d-flex justify-content-center mt-3" *ngIf="totalPages > 1">
    <nav aria-label="Page navigation">
      <ul class="pagination">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <button class="page-link" (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">Previous</button>
        </li>
        <li class="page-item" *ngFor="let page of [].constructor(totalPages); let i = index" [class.active]="i + 1 === currentPage">
          <button class="page-link" (click)="changePage(i + 1)">{{ i + 1 }}</button>
        </li>
        <li class="page-item" [class.disabled]="currentPage === totalPages">
          <button class="page-link" (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages">Next</button>
        </li>
      </ul>
    </nav>
  </div>
</div>